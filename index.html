<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d6d6d; -webkit-text-stroke: #6d6d6d}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #0000ff; -webkit-text-stroke: #0000ff}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6b0001; -webkit-text-stroke: #6b0001}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #fb0007; -webkit-text-stroke: #fb0007}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; -webkit-text-stroke: #000000}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; -webkit-text-stroke: #000000; min-height: 16.0px}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4d5055; -webkit-text-stroke: #4d5055}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6f0ec3; -webkit-text-stroke: #6f0ec3}
    span.s1 {font-kerning: none; background-color: #ecf1f7}
    span.s2 {font-kerning: none; color: #fb0007; background-color: #ecf1f7; -webkit-text-stroke: 0px #fb0007}
    span.s3 {font-kerning: none; color: #2a2a2a; background-color: #ecf1f7; -webkit-text-stroke: 0px #2a2a2a}
    span.s4 {font-kerning: none; color: #6b0001; background-color: #ecf1f7; -webkit-text-stroke: 0px #6b0001}
    span.s5 {font-kerning: none; color: #000000; background-color: #ecf1f7; -webkit-text-stroke: 0px #000000}
    span.s6 {font-kerning: none; color: #0000ff; background-color: #ecf1f7; -webkit-text-stroke: 0px #0000ff}
    span.s7 {font-kerning: none}
    span.s8 {font-kerning: none; color: #093c94; background-color: #ecf1f7; -webkit-text-stroke: 0px #093c94}
    span.s9 {font-kerning: none; color: #18702b; background-color: #ecf1f7; -webkit-text-stroke: 0px #18702b}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p2"><span class="s3">&lt;</span><span class="s4">html</span><span class="s5"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s1">"zh-TW"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s4">meta</span><span class="s5"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s6">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s4">meta</span><span class="s5"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s5"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s4">title</span><span class="s3">&gt;</span><span class="s1">實驗數據統計平台</span><span class="s3">&lt;/</span><span class="s4">title</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">&lt;!-- 引入外掛函式庫：Tailwind, Icons, React, Recharts, html2canvas --&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s4">script</span><span class="s5"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com"</span><span class="s3">&gt;&lt;/</span><span class="s4">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s4">script</span><span class="s5"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://unpkg.com/@phosphor-icons/web"</span><span class="s3">&gt;&lt;/</span><span class="s4">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s4">script</span><span class="s5"> </span><span class="s2">crossorigin</span><span class="s5"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://unpkg.com/react@18/umd/react.production.min.js"</span><span class="s3">&gt;&lt;/</span><span class="s4">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s4">script</span><span class="s5"> </span><span class="s2">crossorigin</span><span class="s5"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"</span><span class="s3">&gt;&lt;/</span><span class="s4">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s4">script</span><span class="s5"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://unpkg.com/@babel/standalone/babel.min.js"</span><span class="s3">&gt;&lt;/</span><span class="s4">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s4">script</span><span class="s5"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://unpkg.com/recharts/umd/Recharts.min.js"</span><span class="s3">&gt;&lt;/</span><span class="s4">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s4">script</span><span class="s5"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"</span><span class="s3">&gt;&lt;/</span><span class="s4">script</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">    </span></span><span class="s1">.hide-scrollbar::-webkit-scrollbar</span><span class="s5"> { </span><span class="s2">display:</span><span class="s5"> </span><span class="s8">none</span><span class="s5">; }</span></p>
<p class="p4"><span class="s5"><span class="Apple-converted-space">    </span></span><span class="s4">.hide-scrollbar</span><span class="s5"> { </span><span class="s1">-ms-overflow-style:</span><span class="s5"> </span><span class="s8">none</span><span class="s5">; </span><span class="s1">scrollbar-width:</span><span class="s5"> </span><span class="s8">none</span><span class="s5">; }</span></p>
<p class="p4"><span class="s5"><span class="Apple-converted-space">    </span></span><span class="s4">body</span><span class="s5"> { </span><span class="s1">font-family:</span><span class="s5"> </span><span class="s9">'Segoe UI'</span><span class="s5">, </span><span class="s8">system-ui</span><span class="s5">, </span><span class="s8">sans-serif</span><span class="s5">; </span><span class="s1">background-color:</span><span class="s5"> </span><span class="s8">#f9fafb</span><span class="s5">; }</span></p>
<p class="p8"><span class="s5"><span class="Apple-converted-space">    </span></span><span class="s4">.export-mode</span><span class="s5"> </span><span class="s4">input</span><span class="s5"> { </span><span class="s2">border:</span><span class="s5"> </span><span class="s8">none</span><span class="s5"> </span><span class="s1">!important</span><span class="s5">; </span><span class="s2">background:</span><span class="s5"> </span><span class="s8">transparent</span><span class="s5"> </span><span class="s1">!important</span><span class="s5">; }</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s3">&lt;</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s4">div</span><span class="s5"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"root"</span><span class="s3">&gt;&lt;/</span><span class="s4">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s4">script</span><span class="s5"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"text/babel"</span><span class="s5"> </span><span class="s2">data-type</span><span class="s3">=</span><span class="s1">"module"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>// --- 從 CDN 引入 Firebase (使用 ESM 語法) ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>import { getFirestore, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>const { useState, useEffect, useRef } = React;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>const { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, LabelList, LineChart, Line } = window.Recharts;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>// --- Firebase 設定 (已修正重複宣告問題) ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>const firebaseConfig = {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>apiKey: "AIzaSyAdO41X5cNZmeC7SUGEt17hRXN3rgauUB8",</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>authDomain: "experiment-platform-489f0.firebaseapp.com",</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>projectId: "experiment-platform-489f0",</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>storageBucket: "experiment-platform-489f0.firebasestorage.app",</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>messagingSenderId: "291865361226",</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>appId: "1:291865361226:web:8ae57d4c5efc422e001fb3",</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>measurementId: "G-Z6PGSL59Y0"</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>let app, auth, db;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>const appId = "my-platform-v1";</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>try {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>app = initializeApp(firebaseConfig);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>auth = getAuth(app);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>db = getFirestore(app);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>} catch (e) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>console.error("Firebase 初始化失敗，改用離線模式", e);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>const COLORS = ['#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6'];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>const DEFAULT_DATA = { groups: ['紙飛機', '彈珠台'], data: {} };</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>// --- 主程式邏輯 ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>function App() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const [appData, setAppData] = useState(DEFAULT_DATA);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const [currentView, setCurrentView] = useState('login');</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const [currentGroup, setCurrentGroup] = useState('');</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const [user, setUser] = useState(null);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const [modal, setModal] = useState(null);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const [isSyncing, setIsSyncing] = useState(false);</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>// 彈窗處理</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const showModal = (msg, type = 'alert', defaultValue = '') =&gt; new Promise(res =&gt; setModal({ msg, type, defaultValue, resolve: res }));</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>// 登入</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>useEffect(() =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>if (!auth) return;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>signInAnonymously(auth).catch(console.error);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>return onAuthStateChanged(auth, setUser);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>}, []);</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>// 雲端同步</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>useEffect(() =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>if (!user || !db) return;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>setIsSyncing(true);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>const unsubscribe = onSnapshot(doc(db, 'artifacts', appId, 'public', 'data', 'main'), (snap) =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>if (snap.exists()) setAppData(snap.data());</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>setIsSyncing(false);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>return unsubscribe;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>}, [user]);</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const save = async (newData) =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>setAppData(newData);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>if (db &amp;&amp; user) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>setIsSyncing(true);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'main'), newData);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>setIsSyncing(false);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>};</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const handleEnter = (g) =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>setCurrentGroup(g);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>if (!appData.data[g]) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>const newData = { ...appData, data: { ...appData.data, [g]: [{ id: Date.now().toString(), name: '新實驗', columns: ['測試一'], rows: [{ id: 'r1', name: '實驗組', values: { '測試一': 0 } }] }] } };</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>save(newData);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>setCurrentView('student');</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>};</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>return (</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div className="min-h-screen"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>&lt;nav className="bg-blue-600 text-white p-4 shadow-md flex justify-between items-center"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>&lt;h1 className="text-xl font-bold flex items-center gap-2"&gt;&lt;i className="ph ph-activity"&gt;&lt;/i&gt; 實驗數據統計平台&lt;/h1&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>{currentView !== 'login' &amp;&amp; &lt;button onClick={() =&gt; setCurrentView('login')} className="text-sm border border-white/50 px-3 py-1 rounded hover:bg-white/10 transition"&gt;返回首頁&lt;/button&gt;}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>&lt;/nav&gt;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>&lt;main className="p-4 max-w-6xl mx-auto"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>{currentView === 'login' ? (</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">              </span>&lt;div className="flex flex-col items-center py-20"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div className="bg-white p-8 rounded-2xl shadow-xl w-full max-w-sm text-center"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;h2 className="text-2xl font-bold mb-6 text-gray-700"&gt;選擇組別&lt;/h2&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;select className="w-full p-3 border rounded-xl mb-6 outline-none focus:ring-2 focus:ring-blue-500" value={currentGroup} onChange={e =&gt; setCurrentGroup(e.target.value)}&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;option value=""&gt;請選擇...&lt;/option&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{appData.groups.map(g =&gt; &lt;option key={g} value={g}&gt;{g}&lt;/option&gt;)}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;/select&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;button onClick={() =&gt; handleEnter(currentGroup)} disabled={!currentGroup} className="w-full bg-blue-600 text-white font-bold py-3 rounded-xl disabled:opacity-50 hover:bg-blue-700 transition"&gt;進入平台&lt;/button&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>) : (</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">              </span>&lt;StudentView group={currentGroup} appData={appData} save={save} isSyncing={isSyncing} showModal={showModal} /&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>)}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>&lt;/main&gt;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>{/* Modal */}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>{modal &amp;&amp; (</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div className="fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">              </span>&lt;div className="bg-white p-6 rounded-2xl shadow-2xl w-full max-w-sm"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h3 className="text-lg font-bold mb-4"&gt;系統提示&lt;/h3&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p className="text-gray-600 mb-6"&gt;{modal.msg}&lt;/p&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>{modal.type === 'prompt' &amp;&amp; &lt;input id="m-input" autoFocus className="w-full p-2 border rounded-lg mb-4 outline-none focus:border-blue-500" defaultValue={modal.defaultValue} /&gt;}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div className="flex justify-end gap-2"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                  </span>{modal.type !== 'alert' &amp;&amp; &lt;button onClick={() =&gt; { modal.resolve(null); setModal(null); }} className="px-4 py-2 text-gray-500 hover:bg-gray-100 rounded-lg"&gt;取消&lt;/button&gt;}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;button onClick={() =&gt; { const val = modal.type === 'prompt' ? document.getElementById('m-input').value : true; modal.resolve(val); setModal(null); }} className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-bold"&gt;確定&lt;/button&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>)}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>function StudentView({ group, appData, save, isSyncing, showModal }) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const exps = appData.data[group] || [];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const [activeId, setActiveId] = useState(exps[0]?.id);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const [isExporting, setIsExporting] = useState(false);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const activeExp = exps.find(e =&gt; e.id === activeId) || exps[0];</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const updateExp = (updated) =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>const newData = { ...appData, data: { ...appData.data, [group]: exps.map(e =&gt; e.id === updated.id ? updated : e) } };</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>save(newData);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>};</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>const handleDownload = async () =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>setIsExporting(true);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>await new Promise(r =&gt; setTimeout(r, 500));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>const canvas = await html2canvas(document.getElementById('chart-area'), { scale: 2 });</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>const link = document.createElement('a');</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>link.download = `實驗數據_${activeExp.name}.png`;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>link.href = canvas.toDataURL();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>link.click();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>setIsExporting(false);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>};</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>if (!activeExp) return &lt;div className="text-center py-20 text-gray-400"&gt;載入中...&lt;/div&gt;;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>return (</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div className="space-y-6"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>&lt;div className="flex justify-between items-center bg-white p-4 rounded-xl shadow-sm border"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div className="flex items-center gap-3"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">              </span>&lt;span className="font-bold text-blue-600 bg-blue-50 px-3 py-1 rounded-lg"&gt;組別：{group}&lt;/span&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">              </span>&lt;span className={`text-xs font-medium px-2 py-1 rounded-full border ${isSyncing ? 'bg-amber-50 text-amber-600 border-amber-200' : 'bg-green-50 text-green-600 border-green-200'}`}&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>{isSyncing ? '同步中...' : '已儲存至雲端'}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">              </span>&lt;/span&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>&lt;button onClick={handleDownload} className="flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-bold text-sm shadow-md transition-all active:scale-95"&gt;&lt;i className="ph ph-download-simple"&gt;&lt;/i&gt; 下載圖表&lt;/button&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>&lt;div id="chart-area" className={`bg-white p-6 rounded-2xl shadow-sm border ${isExporting ? 'export-mode' : ''}`}&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div className="mb-8 space-y-4"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">              </span>&lt;div className="flex items-center gap-2"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;label className="font-bold text-gray-500 whitespace-nowrap"&gt;實驗名稱：&lt;/label&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;input className="text-2xl font-black w-full outline-none focus:border-b-2 border-blue-500" value={activeExp.name} onChange={e =&gt; updateExp({...activeExp, name: e.target.value})} /&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div className="grid grid-cols-1 lg:grid-cols-2 gap-8"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">              </span>&lt;div className="space-y-4"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div className="flex justify-between items-center"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;h3 className="font-bold text-lg flex items-center gap-2 text-gray-700"&gt;&lt;i className="ph ph-table"&gt;&lt;/i&gt; 數據表格&lt;/h3&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                  </span>{!isExporting &amp;&amp; (</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div className="flex gap-2"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;button onClick={() =&gt; updateExp({...activeExp, columns: [...activeExp.columns, `測試${activeExp.columns.length+1}`]})} className="text-xs bg-green-50 text-green-600 px-2 py-1 rounded border border-green-200 hover:bg-green-100 font-bold"&gt;+ 欄位&lt;/button&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;button onClick={() =&gt; updateExp({...activeExp, rows: [...activeExp.rows, { id: Date.now().toString(), name: '新數據', values: {} }]})} className="text-xs bg-blue-50 text-blue-600 px-2 py-1 rounded border border-blue-200 hover:bg-blue-100 font-bold"&gt;+ 列位&lt;/button&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                  </span>)}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div className="overflow-x-auto"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;table className="w-full text-sm border-collapse"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;thead&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;tr className="bg-gray-100 text-gray-600"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;th className="p-3 border"&gt;項目&lt;/th&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>{activeExp.columns.map(c =&gt; &lt;th key={c} className="p-3 border"&gt;{c}&lt;/th&gt;)}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/tr&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/thead&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;tbody&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                      </span>{activeExp.rows.map(row =&gt; (</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;tr key={row.id}&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;td className="p-2 border font-bold text-gray-700"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;input className="w-full text-center outline-none" value={row.name} onChange={e =&gt; updateExp({...activeExp, rows: activeExp.rows.map(r =&gt; r.id === row.id ? {...r, name: e.target.value} : r)})} readOnly={isExporting} /&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/td&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                          </span>{activeExp.columns.map(c =&gt; (</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td key={c} className="p-2 border"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;input type="number" className="w-full text-center outline-none font-mono" value={row.values[c] || 0} onChange={e =&gt; updateExp({...activeExp, rows: activeExp.rows.map(r =&gt; r.id === row.id ? {...r, values: {...r.values, [c]: parseFloat(e.target.value)||0}} : r)})} readOnly={isExporting} /&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/td&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                          </span>))}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/tr&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                      </span>))}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/tbody&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;/table&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">              </span>&lt;div className="space-y-4"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h3 className="font-bold text-lg flex items-center gap-2 text-gray-700"&gt;&lt;i className="ph ph-chart-bar"&gt;&lt;/i&gt; 統計圖表&lt;/h3&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div className="bg-gray-50 p-4 rounded-xl border border-dashed border-gray-300 min-h-[300px]"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;ResponsiveContainer width="100%" height={300}&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;BarChart data={activeExp.columns.map(c =&gt; ({ name: c, ...activeExp.rows.reduce((acc, r) =&gt; ({ ...acc, [r.name]: r.values[c] || 0 }), {}) }))}&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;CartesianGrid strokeDasharray="3 3" vertical={false} /&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;XAxis dataKey="name" /&gt; &lt;YAxis /&gt; &lt;Tooltip /&gt; &lt;Legend /&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                      </span>{activeExp.rows.map((r, i) =&gt; &lt;Bar key={r.id} dataKey={r.name} fill={COLORS[i % COLORS.length]} radius={[4, 4, 0, 0]} isAnimationActive={!isExporting} /&gt;)}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/BarChart&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;/ResponsiveContainer&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">      </span>);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p6"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>const root = ReactDOM.createRoot(document.getElementById('root'));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span>root.render(&lt;App /&gt;);</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
</body>
</html>
